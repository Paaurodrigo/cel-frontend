<div class="container-fluid py-5">
  <div class="row justify-content-center">
    <div class="col-xxl-8 col-xl-9 col-lg-10">
      <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
       <!-- Cabecera unificada para todas las tarjetas -->
<div class="card-header bg-primary text-white py-4">
  <div class="d-flex align-items-center px-3">
    <i class="bi bi-person-circle display-6 me-3 text-white"></i>
    <div>
      <h2 class="fw-bold mb-0">Edición de Socio</h2>
      <p class="mb-0 opacity-75">Modifique los datos del socio</p>
    </div>
  </div>
</div>


        <div class="card-body p-4 p-lg-5">
          <form [formGroup]="oPerfilForm!" (ngSubmit)="onSubmit()" novalidate>
            <!-- Secciones del formulario -->
            <div class="row g-4">
              <!-- Datos Personales -->
              <div class="col-12">
                <h5 class="border-bottom pb-2 mb-4">
                  <i class="bi bi-person-badge me-2"></i>Datos Personales
                </h5>
              </div>

              <!-- ID -->
              

              <!-- Nombre -->
              <div class="col-md-4">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Nombre</mat-label>
                  <input matInput formControlName="nombre" placeholder="Ej: Juan" />
                  <mat-icon matSuffix>badge</mat-icon>
                  <mat-error *ngIf="oPerfilForm.get('nombre')?.invalid && oPerfilForm.get('nombre')?.touched">
                    Campo obligatorio (3-50 caracteres)
                  </mat-error>
                </mat-form-field>
              </div>

              <!-- Primer Apellido -->
              <div class="col-md-4">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Primer Apellido</mat-label>
                  <input matInput formControlName="apellido1" placeholder="Ej: García" />
                  <mat-icon matSuffix>badge</mat-icon>
                  <mat-error *ngIf="oPerfilForm.get('apellido1')?.invalid && oPerfilForm.get('apellido1')?.touched">
                    Campo obligatorio (3-50 caracteres)
                  </mat-error>
                </mat-form-field>
              </div>

              <!-- Segundo Apellido -->
              <div class="col-md-4">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Segundo Apellido</mat-label>
                  <input matInput formControlName="apellido2" placeholder="Ej: Pérez" />
                  <mat-icon matSuffix>badge</mat-icon>
                </mat-form-field>
              </div>

              <!-- Identificación -->
              <div class="col-12 mt-4">
                <h5 class="border-bottom pb-2 mb-4">
                  <i class="bi bi-shield-lock me-2"></i>Identificación
                </h5>
              </div>

              <!-- DNI -->
              <div class="col-md-6">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>DNI</mat-label>
                  <input matInput formControlName="dni" readonly />
                  <mat-icon matSuffix>badge</mat-icon>
                </mat-form-field>
              </div>

              <!-- Email -->
              <!-- Email -->
              <div class="col-md-6">
                <mat-form-field appearance="outline" class="w-100"
                  [class.mat-form-field-invalid]="emailExiste && oPerfilForm.get('email')?.touched">
                  <mat-label>Email</mat-label>
                  <input matInput formControlName="email" (input)="onEmailChange()" 
                         placeholder="ejemplo@email.com" type="email" />
                  
                  <mat-icon matSuffix *ngIf="!emailExiste && oPerfilForm.get('email')?.valid" color="primary">check_circle</mat-icon>
                  <mat-icon matSuffix *ngIf="emailExiste && oPerfilForm.get('email')?.touched" color="warn">error</mat-icon>

                  <mat-error *ngIf="oPerfilForm.get('email')?.hasError('required') && oPerfilForm.get('email')?.touched">
                    Email obligatorio
                  </mat-error>
                  <mat-error *ngIf="oPerfilForm.get('email')?.hasError('email') && oPerfilForm.get('email')?.touched">
                    Formato de email incorrecto
                  </mat-error>
                  <mat-error *ngIf="emailExiste && oPerfilForm.get('email')?.touched">
                    Email ya registrado
                  </mat-error>
                </mat-form-field>
              </div>

              <!-- Información de Contacto -->
              <div class="col-12 mt-4">
                <h5 class="border-bottom pb-2 mb-4">
                  <i class="bi bi-geo-alt me-2"></i>Información de Contacto
                </h5>
              </div>

              <!-- Teléfono -->
              <div class="col-md-4">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Teléfono</mat-label>
                  <input matInput formControlName="telefono" placeholder="123456789" />
                  <mat-icon matSuffix>phone</mat-icon>
                  <mat-error *ngIf="oPerfilForm.get('telefono')?.invalid && oPerfilForm.get('telefono')?.touched">
                    Teléfono válido (9 dígitos)
                  </mat-error>
                </mat-form-field>
              </div>

              <!-- Dirección Fiscal -->
              <div class="col-md-5">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Dirección Fiscal</mat-label>
                  <input matInput formControlName="direccionfiscal" placeholder="Dirección Fiscal" />
                  <mat-icon matSuffix>location_on</mat-icon>
                  <mat-error *ngIf="oPerfilForm.get('direccionfiscal')?.invalid && oPerfilForm.get('direccionfiscal')?.touched">
                    Dirección obligatoria (3-50 caracteres)
                  </mat-error>
                </mat-form-field>
              </div>

              <!-- Código Postal -->
              <div class="col-md-3">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Código Postal</mat-label>
                  <input matInput formControlName="codigopostal" placeholder="12345" />
                  <mat-icon matSuffix>local_post_office</mat-icon>
                  <mat-error *ngIf="oPerfilForm.get('codigopostal')?.invalid && oPerfilForm.get('codigopostal')?.touched">
                    CP válido (5 dígitos)
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <!-- Botones de acción -->
            <div class="d-flex flex-wrap justify-content-center gap-3 mt-5">
              <button type="button" class="btn btn-outline-secondary px-4" [routerLink]="['/']">
                <i class="bi bi-arrow-left me-2"></i>Volver a la página principal
              </button>
              <button type="reset" class="btn btn-outline-danger px-4" (click)="onReset()">
                <i class="bi bi-x-circle me-2"></i>Limpiar formulario
              </button>
              <button type="submit" class="btn btn-primary px-4" 
              [disabled]="!oPerfilForm.valid || emailExiste">
        <i class="bi bi-check2-circle me-2"></i>Guardar cambios
      </button>
            </div>

            <!-- Mensajes de error/éxito -->
            <div *ngIf="strMessage" class="mt-3 text-center" [ngClass]="{ 'text-success': showSuccess, 'text-danger': !showSuccess }">
              {{ strMessage }}
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>
</div>


